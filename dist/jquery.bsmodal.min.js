/*!
 * jquery.bsmodal.js v1.2.0
 * https://github.com/ycs77/jquery-plugin-bsModal
 *
 * Copyright 2018-2021 Lucas Yang
 * Released under the MIT license
 *
 * Date: 2021-03-02T09:39:15.177Z
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).$)}(this,function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c=e(t);function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
   * recursive-object-assign
   * https://github.com/gmasmejean/recursiveAssign
   */var l=function(o,n){Object.keys(n).forEach(function(t){var e,a;e=o,t=n[a=t],i(t)?(i(e[a])||(e[a]={}),l(e[a],t)):e[a]=t})},i=function(t){return null!=t&&void 0!==t.constructor&&t.constructor.prototype===Object.prototype};function u(e){if("object"===n(e)){for(var t=arguments.length,a=new Array(1<t?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];a.forEach(function(t){i(t)&&l(e,t)})}return e}function s(t,i,r){var d,c,u;null!==i.width||null!==i.height?(d=document.createElement("canvas"),c=d.getContext("2d"),(u=new Image).src=t,u.onload=function(){var t,e,a,o,n=u.naturalWidth,l=u.naturalHeight,e=(t=n,e=l,a=i.width,o=i.height,Math.min(a/t,o/e));d.width=n*e,d.height=l*e,c.drawImage(u,0,0,n,l,0,0,n*e,l*e),r(d.toDataURL())}):r(t)}c.default.fn&&(c.default.fn.bsModal=function(t){var e=this,a=u({},a={id:"exampleModal",title:"Modal title",titleLavel:5,body:"",label:null,lang:null,langs:{en:{okBtn:{text:"Save"},cancelBtn:{text:"Close"},confirmOkText:"OK",confirmCancelText:"Cancel"},"zh-TW":{okBtn:{text:"儲存"},cancelBtn:{text:"關閉"},confirmOkText:"確定",confirmCancelText:"取消"}},modal:null,fade:!0,close:!0,backdrop:!0,confirm:!1,okBtn:{text:"",color:"primary"},cancelBtn:{text:"",color:"secondary"},confirmOkText:"",confirmCancelText:"",onOpen:function(){return!0},onClose:function(){return!0},onOk:function(){return!0},onCancel:function(){return!0}},a.langs[a.lang]||a.langs[navigator.language||navigator.userLanguage]||a.langs.en),o=u({},a,t);o.label=o.label||"".concat(o.id,"Label"),void 0===t.close&&(o.close=!1),void 0===t.backdrop&&(o.backdrop="static");var n,l,i=null;return"string"==typeof o.modal&&(i=c.default(o.modal)),null===i&&(i=c.default('<div class="modal" />').addClass(o.fade?"fade":"").attr({id:o.id,tabindex:"-1",role:"dialog","aria-labelledby":o.label,"data-backdrop":o.backdrop}).appendTo("body"),a=c.default('<div class="modal-dialog" />').attr({role:"document"}).appendTo(i),t=c.default('<div class="modal-content" />').appendTo(a),a=c.default('<div class="modal-header" />').appendTo(t),c.default("<h".concat(o.titleLavel,' class="modal-title" />')).attr("id",o.label).html(o.title).css("display","inline").appendTo(a),o.close&&c.default('<button class="close" type="button" data-dismiss="modal" aria-label="Close" />').append(c.default('<span aria-hidden="true">&times;</span>')).appendTo(a),o.body&&c.default('<div class="modal-body" />').html(o.body).appendTo(t),(o.cancelBtn||o.okBtn)&&(t=c.default('<div class="modal-footer" />').appendTo(t),o.cancelBtn&&(n=c.default('<button type="button" data-dismiss="modal" />').addClass("btn btn-".concat(o.cancelBtn.color)).text(o.confirm?o.confirmCancelText:o.cancelBtn.text).appendTo(t)),o.okBtn&&(l=c.default('<button type="button" />').addClass("btn btn-".concat(o.okBtn.color)).text(o.confirm?o.confirmOkText:o.okBtn.text).appendTo(t))),i.on("shown.bs.modal",function(){o.onOpen.call(e)}),i.on("hidden.bs.modal",function(){o.onClose.call(e)}),l&&l.on("click",function(){!1!==o.onOk.call(e)&&i.modal("hide")}),n&&n.on("click",function(){o.onCancel.call(e)})),this.modal=i,this.attr({"data-toggle":"modal","data-target":"#".concat(i.attr("id"))}),this},c.default.fn.bsModalCropper=function(t){var l=this;if("undefined"==typeof Cropper)throw"Error: Cropper.js is not found.";var a,i=u({},{id:"exampleModalCropper",confirm:!0,src:null,imgId:"exampleImage",cropper:{viewMode:1},maxWidth:null,maxHeight:null,imageMimeType:"auto",uploadFile:null,action:null,method:"post",fileName:"file",data:{},uploadConfig:{allowTypes:["image/jpeg","image/png"],maxSize:5*Math.pow(1024,2)},success:function(){},error:function(){},axios:null,axiosOriginalData:!1,onUpload:function(){return!0},onUploadError:function(){return!0},onCropper:function(){return!0}},t),r=c.default("<img />").attr("id",i.imgId).css("max-width","100%");i.body=c.default('<div class="img-container" />').append(r);var o=i.onOpen;i.onOpen=function(){if("auto"===i.imageMimeType){try{atob(i.src.split(",")[1]),i.imageMimeType=i.src.split(":")[1].split(";")[0]}catch(t){var e;t instanceof DOMException&&(e=i.src.match(/\.(\w+)$/),i.imageMimeType={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",svg:"image/svg+xml",webp:"image/webp"}[e&&e[1]])}"auto"===i.imageMimeType&&(i.imageMimeType="image/jpeg")}a=new Cropper(r.get(0),i.cropper),o&&o()};var e=i.onOk;i.onOk=function(){e&&e();var t=a.getCroppedCanvas().toDataURL(i.imageMimeType);a.destroy(),s(t,{width:i.maxWidth,height:i.maxHeight},function(t){var e,a=function(t){for(var e=(0<=t.split(",")[0].indexOf("base64")?atob:unescape)(t.split(",")[1]),t=t.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(e.length),o=0;o<e.length;o++)a[o]=e.charCodeAt(o);return new Blob([a],{type:t})}(t);i.onCropper.call(l,t,a,i.uploadFile),"string"==typeof i.action&&((e=new FormData).append(i.fileName,a),Object.keys(i.data).forEach(function(t){e.append(t,i.data[t])}),function(e,t){if(e.axios)e.axios({url:e.action,method:e.method,data:t,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.success(e.axiosOriginalData?t:t.data)}).catch(e.error);else{if(void 0===c.default.ajax)throw"Error: ajax function is not found, Can't upload image.";c.default.ajax(e.action,{method:e.method,data:t,processData:!1,contentType:!1,success:e.success,error:e.error})}}(i,e))})};var d,n=i.onCancel;return i.onCancel=function(){a.destroy(),n&&n()},i.src?(r.attr("src",i.src),i.uploadFile=null,this.bsModal(i)):(d=this.children("input[type=file]").get(0)).onchange=function(){if(d.files.length){var e,a=d.files[0];if(i.uploadFile=a,d.value="",!1!==i.onUpload.call(l,i.uploadFile)){if(i.uploadConfig.allowTypes)if(!i.uploadConfig.allowTypes.some(function(t){return t===a.type}))return void i.onUploadError.call(l,"Upload file type is wrong");if(i.uploadConfig.maxSize){var t=i.uploadConfig.maxSize;if(a.size>t){var o=Math.floor(Math.log(t)/Math.log(1024)),n=+(t/Math.pow(1024,o)).toFixed(2)+" "+["B","kB","MB","GB","TB"][o];return void i.onUploadError.call(l,"Uploaded file cannot be larger than ".concat(n))}}o=a,e=function(t){i.src=t,r.attr("src",i.src),l.bsModal(i),l.modal.modal("show"),l.removeAttr("data-toggle").removeAttr("data-target")},(n=new FileReader).onload=function(t){e(t.target.result)},n.readAsDataURL(o)}}},this})});